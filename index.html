<!doctype html>
<html lang="id" translate="no">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>Masakin</title>
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="google" content="notranslate" />
    <meta property="og:title" content="Masakin - Solusi Pintar Dapurmu" />
    <meta
      property="og:description"
      content="Temukan resep masakan dari bahan yang ada di kulkasmu. Bagikan resep buatanmu sendiri!"
    />
    <meta
      property="og:image"
      content="https://masakin.my.id/icon.png"
    />
    <meta property="og:url" content="https://masakin.my.id" />
    <meta property="og:type" content="website" />
    <link rel="stylesheet" href="style.css" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#ffffff" />
    <script src="https://unpkg.com/feather-icons"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap"
      rel="stylesheet"
    />

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  </head>
  <body>
    <header id="main-header" style="display: flex; justify-content: space-between; align-items: center;">
      <div class="app-logo" style="display: flex; align-items: center;">
        <img src="icon/logo-header-terang.png" alt="Masakin" class="logo-light" style="height: 32px;">
        <img src="icon/logo-header-gelap.png" alt="Masakin" class="logo-dark" style="height: 32px;">
      </div>
      <div class="header-actions" style="display: flex; align-items: center; gap: 12px;">
        <button class="notif-btn" onclick="toggleNotifSheet()">
          <i data-feather="bell"></i>
          <span class="notif-dot"></span>
        </button>
        <div class="profile-pill" onclick="switchPage('profile-page')">
          <div class="avatar" id="header-avatar">G</div>
          <div class="profile-info">
            <span class="app-name">Halo,</span>
            <span class="user-name" id="header-username">Guest User</span>
          </div>
        </div>
      </div>
    </header>

    <main>
      <section id="home" class="page active">
        <div class="hero">
          <h1>Mau masak apa hari ini?</h1>
          <p>Pilih bahan yang tersedia, kami carikan resepnya.</p>
        </div>
        <div class="ingredients-grid" id="ingredients-container"></div>

        <div class="floating-action">
          <button class="find-btn" onclick="findRecipes()">
            Cari Resep <i data-feather="arrow-right"></i>
          </button>
        </div>

        <div
          id="recipe-results"
          class="recipe-list"
          style="display: none; font-size: 13px"
        >
          <div class="divider"></div>
          <h2>Hasil pencarian:</h2>
          <div id="results-container"></div>
        </div>
      </section>

      <section id="explore" class="page">
        <div
          class="section-title"
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
          "
        >
          <div>
            <h2 style="margin: 0">Jelajahi Tips</h2>
            <p style="margin: 0; font-size: 12px; color: var(--text-muted)">
              Artikel & lifehack dapur terbaru.
            </p>
          </div>
          <div class="search-box">
            <i
              data-feather="search"
              style="width: 16px; height: 16px; color: var(--text-muted)"
            ></i>
            <input
              type="text"
              id="explore-search"
              onkeyup="searchGrid('explore-search', 'explore-container')"
              placeholder="Cari artikel..."
            />
          </div>
        </div>
        <div class="masonry-grid" id="explore-container"></div>
      </section>
      <div id="public-profile-page" class="detail-overlay" style="background: var(--bg); z-index: 900;">
        <div style="display: flex; align-items: center; gap: 15px; padding: 15px 20px; border-bottom: 1px solid var(--border, #ddd); position: sticky; top: 0; background: var(--surface, #fff); z-index: 10;">
            <button onclick="closePublicProfile()" style="background:none; border:none; font-size:20px; cursor:pointer; color: var(--text);">
                <i data-feather="arrow-left"></i>
            </button>
            <h3 id="public-profile-title" style="margin: 0; flex: 1;">Profil</h3>
        </div>

        <div style="padding: 20px; text-align: center;">
            <img id="public-profile-avatar" src="" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; margin-bottom: 10px; border: 2px solid var(--primary, #ff6b6b);">
            <h2 id="public-profile-name" style="margin: 0 0 5px 0; font-size: 18px;">Nama Pengguna</h2>
            
            <div style="display: flex; gap: 30px; justify-content: center; margin: 15px 0;">
                <div onclick="showFollowList('followers')" style="cursor: pointer; padding: 5px;">
                    <h3 id="public-followers" style="margin: 0;">0</h3>
                    <span style="font-size: 12px; color: var(--text-muted);">Pengikut</span>
                </div>
                <div onclick="showFollowList('following')" style="cursor: pointer; padding: 5px;">
                    <h3 id="public-following" style="margin: 0;">0</h3>
                    <span style="font-size: 12px; color: var(--text-muted);">Mengikuti</span>
                </div>
            </div>

            <button id="btn-follow-public" class="btn-follow" style="display: none; width: 150px; margin: 0 auto; padding: 10px; border-radius: 20px; font-weight: bold; cursor: pointer; border: none; background: var(--primary, #ff6b6b); color: white;" onclick="toggleFollowPublic()">
                + Ikuti
            </button>
        </div>

        <div style="padding: 0 20px 40px 20px;">
            <h4 style="margin-bottom: 15px; border-bottom: 2px solid var(--border, #ddd); padding-bottom: 10px;">Resep Kiriman</h4>
            <div id="public-profile-recipes" class="masonry-grid"></div>
        </div>
    </div>

    <div id="follow-list-modal" class="popup-overlay" style="display: none; z-index: 1000;">
        <div class="popup-card" style="max-height: 80vh; display: flex; flex-direction: column;">
            <div class="popup-header">
                <h3 id="follow-list-title">Pengikut</h3>
                <button class="close-popup" onclick="document.getElementById('follow-list-modal').style.display='none'">
                    <i data-feather="x"></i>
                </button>
            </div>
            <div id="follow-list-content" style="overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 15px;">
                </div>
        </div>
    </div>

      <section id="menu-page" class="page">
        <div
          class="section-title"
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
          "
        >
          <div>
            <h2 style="margin: 0">Inspirasi Menu</h2>
            <p style="margin: 0; font-size: 12px; color: var(--text-muted)">
              Temukan menu terbaikmu.
            </p>
          </div>
          <div class="search-box">
            <i
              data-feather="search"
              style="width: 16px; height: 16px; color: var(--text-muted)"
            ></i>
            <input
              type="text"
              id="menu-search"
              onkeyup="searchGrid('menu-search', 'menu-container')"
              placeholder="Cari resep..."
            />
          </div>
        </div>
        <div class="masonry-grid" id="menu-container"></div>
      </section>

      <section id="favorit" class="page">
        <div
          class="section-title"
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
          "
        >
          <div>
            <h2 style="margin: 0">Favoritku</h2>
            <p style="margin: 0; font-size: 12px; color: var(--text-muted)">
              Semua yang kamu sukai.
            </p>
          </div>
          <div class="search-box">
            <i
              data-feather="search"
              style="width: 16px; height: 16px; color: var(--text-muted)"
            ></i>
            <input
              type="text"
              id="favorit-search"
              onkeyup="searchGrid('favorit-search', 'favorit-container')"
              placeholder="Cari favorit..."
            />
          </div>
        </div>
        <div class="masonry-grid" id="favorit-container"></div>
      </section>

      <section id="profile-page" class="page profile-container">
        <div style="padding: 0 5px 15px">
          <h2 style="margin: 0; font-size: 24px">Akun Saya</h2>
          <p style="margin: 0; font-size: 14px; color: var(--text-muted)">
            Kelola profil dan preferensi
          </p>
        </div>

        <div class="profile-header-large">
          <div class="avatar-large" id="profile-avatar-large">G</div>
          <h2 id="profile-name-large">Guest User</h2>
          <div id="my-profile-stats" class="profile-stats" style="display: none; gap: 20px; justify-content: center; margin-top: 10px;">
            <div style="text-align: center;">
                <h3 id="count-followers" style="margin: 0; color: var(--text);">0</h3>
                <span style="font-size: 12px; color: var(--text-muted);">Pengikut</span>
            </div>
            <div style="text-align: center;">
                <h3 id="count-following" style="margin: 0; color: var(--text);">0</h3>
                <span style="font-size: 12px; color: var(--text-muted);">Mengikuti</span>
            </div>
        </div>
          <p id="profile-email-large">Silakan Login</p>
          <div id="auth-btn-container"></div>
        </div>

        <div class="my-recipes-section" style="padding: 0 20px 20px">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 15px;
            "
          >
            <h4 style="margin: 0; font-size: 16px">Resepku</h4>
            <button
              onclick="openRecipeForm()"
              style="
                background: var(--primary);
                color: white;
                border: none;
                width: 30px;
                height: 30px;
                border-radius: 50%;
                font-size: 18px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 20;
              "
            >
              <i data-feather="plus" style="width: 16px; height: 16px"></i>
            </button>
          </div>
          <div id="my-recipes-scroll" class="horizontal-scroll"></div>
        </div>

        <div class="menu-list">
          <div class="menu-group">
            <h4>Preferensi</h4>
            <div class="menu-item" id="theme-btn" onclick="toggleTheme()">
              <i data-feather="moon"></i> Mode Gelap
            </div>
            <div class="menu-item" id="install-btn" style="display: none">
              <i data-feather="download"></i> Unduh Aplikasi
            </div>
          <div class="menu-group">
            <h4>Info & Bantuan</h4>
            <div class="menu-item" onclick="openPopup('bantuan')">
              <i data-feather="help-circle"></i> Bantuan & FAQ
            </div>
            <div class="menu-item" onclick="openPopup('privasi')">
              <i data-feather="shield"></i> Kebijakan Privasi
            </div>
            <div class="menu-item" onclick="openPopup('tentang')">
              <i data-feather="info"></i> Tentang Aplikasi
            </div>
          </div>
          <div class="menu-group">
            <button
              class="menu-item"
              style="
                width: 100%;
                border: none;
                background: #0095f6;
                color: #ffffff;
                justify-content: center;
                font-weight: 600;
              "
              onclick="
                window.open('https://trakteer.id/mhmmdazizy/tip', '_blank')
              "
            >
              <i data-feather="coffee"></i> Traktir Kopi Developer
            </button>
            <button class="reset-btn" onclick="resetData()">
              <i data-feather="trash-2"></i> Hapus Data & Reset
            </button>
          </div>

          <div
            style="
              text-align: center;
              margin-top: 30px;
              margin-bottom: 20px;
              font-size: 12px;
              color: var(--text-muted);
            "
          >
            Made with
            <i
              data-feather="heart"
              style="width: 12px; height: 12px; color: red; fill: red"
            ></i>
            by
            <a
              href="https://instagram.com/mhmmdazizy"
              style="
                color: var(--primary);
                text-decoration: none;
                font-weight: 600;
              "
              >Muhammad Azizy</a
            >
          </div>
        </div>
      </section>
    </main>

    <div id="notif-sheet" class="bottom-sheet">
      <div class="sheet-handle"></div>
      <div
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 15px;
        "
      >
        <h3 style="margin: 0">Notifikasi</h3>
      </div>

      <div class="notif-list" id="notif-list-container">
        <p
          style="
            text-align: center;
            color: #888;
            font-size: 12px;
            margin-top: 20px;
          "
        >
          Memuat notifikasi...
        </p>
      </div>
    </div>
    <div
      id="sheet-backdrop"
      class="backdrop"
      onclick="toggleNotifSheet()"
    ></div>

    <div id="info-popup" class="popup-overlay">
      <div class="popup-card">
        <div class="popup-header">
          <h3 style="display: flex; align-items: center; gap: 10px">
            <i id="popup-icon"></i>
            <span id="popup-title">Info</span>
          </h3>
          <button class="close-popup" onclick="closePopup()">
            <i data-feather="x"></i>
          </button>
        </div>
        <div class="popup-content" id="popup-body"></div>
      </div>
    </div>

    <nav class="bottom-nav">
      <a href="javascript:void(0)" class="nav-item active" onclick="switchPage('home')">
        <i data-feather="home"></i>
        <span>Home</span>
      </a>
      <a href="javascript:void(0)" class="nav-item" onclick="switchPage('explore')">
        <i data-feather="compass"></i>
        <span>Jelajah</span>
      </a>
      <a href="javascript:void(0)" class="nav-item" onclick="switchPage('menu-page')">
        <i data-feather="book-open"></i>
        <span>Menu</span>
      </a>
      <a href="javascript:void(0)" class="nav-item" onclick="switchPage('favorit')">
        <i data-feather="heart"></i>
        <span>Favorit</span>
      </a>
      <a
        href="javascript:void(0)"
        class="nav-item"
        id="nav-profile"
        onclick="switchPage('profile-page')"
      >
        <i data-feather="user"></i>
        <span>Profil</span>
      </a>
    </nav>
    <div id="article-view" class="detail-overlay">
      <div class="detail-header">
        <button onclick="closeArticle()">
          <i data-feather="arrow-left"></i>
        </button>
        <span id="detail-category">KATEGORI</span>
        <button onclick="shareArticle()"><i data-feather="share-2"></i></button>
      </div>
      <div class="detail-hero" id="detail-image"></div>
      <div class="detail-body">
        <h1 id="detail-title">Judul Artikel</h1>
        <div
          class="detail-meta"
          style="
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            color: var(--text-muted);
            font-size: 12px;
            margin-bottom: 15px;
          "
        >
          <span>
            <span id="detail-author-container">Admin</span>
          </span>
          <span>
            <i data-feather="clock" style="width: 14px"></i>
            <span id="detail-time">- Menit</span>
          </span>
          <span>
            <i data-feather="users" style="width: 14px"></i>
            <span id="detail-servings">- Porsi</span>
          </span>
        </div>

        <div class="detail-content" id="detail-desc"></div>
        <div id="detail-ratings" class="rating-container">
            </div>
        <div id="detail-reactions" class="reaction-container">
            </div>
        <div id="detail-comments" class="comments-section">
            <h4 style="margin-bottom: 15px; color: var(--text);">Komentar</h4>
            
            <div id="comments-list" class="comments-list">
                </div>

            <div class="comment-input-area" style="padding-bottom: 40px;">
                <textarea id="comment-input" class="form-input" rows="2" placeholder="Tulis pendapatmu tentang resep ini..."></textarea>
                
                <button class="find-btn" onclick="submitComment(this)">
                    Kirim Komentar
                </button>
            </div>
        </div>
      </div>
    </div>
    <div
      id="recipe-form"
      class="popup-overlay"
      style="display: none; align-items: flex-end; justify-content: center"
    >
      <div class="popup-card">
        <div class="popup-header">
          <h3>Buat Resep Baru</h3>
          <button class="close-popup" onclick="closeRecipeForm()">
            <i data-feather="x"></i>
          </button>
        </div>

        <input type="hidden" id="edit-index" />
        <input type="hidden" id="edit-id" />
        <label>Nama Masakan</label>
        <input
          type="text"
          id="rec-title"
          class="form-input"
          placeholder="Nasi Goreng..."
          oninput="this.style.borderColor=''; document.getElementById('error-title').style.display='none';"
        />
        <div id="error-title" style="color: #dc3545; font-size: 11px; margin-top: -12px; margin-bottom: 12px; margin-left: 4px; display: none;">
          Judul wajib diisi!
        </div>

        <label>Kategori (Pedas/Manis/Kuah)</label>
        <input
          type="text"
          id="rec-tag"
          class="form-input"
          placeholder="PEDAS"
        />

        <label>Foto Sampul</label>
        <input type="file" id="rec-file" class="form-input" accept="image/*" />
        
        <div id="rec-file-status"></div>

        <input type="hidden" id="rec-img" />

        <div style="display: flex; gap: 15px; margin-bottom: 15px;">
          
          <div style="flex: 1;">
            <label>Waktu Masak</label>
            <div style="position: relative;">
              <input type="number" id="input-time" class="form-input" placeholder="30" style="padding-right: 60px; width: 100%; margin-bottom: 0;">
              
              <span style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--text-muted); font-size: 13px; font-weight: bold; pointer-events: none;">
                Menit
              </span>
            </div>
          </div>

          <div style="flex: 1;">
            <label>Jumlah Sajian</label>
            <div style="position: relative;">
              <input type="number" id="input-servings" class="form-input" placeholder="4" style="padding-right: 60px; width: 100%; margin-bottom: 0;">
              <span style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--text-muted); font-size: 13px; font-weight: bold; pointer-events: none;">
                Porsi
              </span>
            </div>
          </div>

        </div>

        <label><span>Bahan-bahan</span><span style="font-size: 11px; opacity: 0.7;"> (Pisahkan dengan Enter)</span></label>

        <textarea id="rec-ingredients" class="form-input" rows="4" placeholder="Contoh:&#10;200g Nasi Putih&#10;2 Siung Bawang Putih&#10;1 Butir Telur"></textarea>

        <label>Langkah-langkah</label>
        
        <div id="steps-container" class="steps-carousel">
            
            <div class="step-card">
                <div class="step-header">
                    <span class="step-number">Langkah 1</span>
                </div>
                <textarea class="step-text form-input" rows="3" placeholder="Tumis bawang putih hingga harum..."></textarea>
                <input type="file" class="step-img form-input" accept="image/*" style="font-size: 12px; padding: 8px;">
            </div>

        </div>

        <button type="button" class="btn-add-step" onclick="addStepCard()">
            + Tambah Langkah
        </button>

        <button class="find-btn" onclick="saveMyRecipe()">Simpan</button>
      </div>
    </div>

    <script src="database.js"></script>
    <script src="app.js"></script>
    <div id="toast-notif"></div>
  </body>
</html>
